---
published: false
layout: post
title: "啥？线性回归也能处理时序数据？"
categories: 我的AI新书
date: 2023-09-21 00:00:00 +0800
excerpt: "啥？线性回归也能处理时序数据？"
---


当我搜索时序数据处理工具时，满屏都是RNN的身影，所以我一直以为RNN专属于时序数据，这种天真的想法让我形成了一种先入为主的偏见：RNN等价于时序数据。

结果当我看到逻辑回归也能玩时序数据的文章时，我的世界观瞬间崩塌!我就去向大模型表达我的惊讶，结果却被大模型无情地打脸。


什么是时序数据？
时序数据就是一系列随时间记录下来的观测值。这些观测值通常以固定的时间频率记录,比如日度或月度。


例如，下面这个时间序列数据记录了某店30天内的硬皮书销量,我们用列Hardcover表示销量,用Date表示日期。


线性回归怎么玩时序数据？
线性回归是一种用来描述一个或多个自变量和因变量之间关系的机器学习方法。
对于两个特征,会有:

ŷ = w0 + w1 * x1 + w2 * x2

x可以是房屋的面积，房间数等等。


训练时回归算法自动找到最合适的权重,叫回归系数。常见算法是最小二乘法,让预测值离真值足够近。

线性回归能处理时间序列数据的关键是构造随时间变化的特征，时间序列中有两类独特的特征:时间步特征和滞后特征。

时间步特征

时间步特征是我们可以直接从时间索引中获取的特征。最基本的时间步特征是时间虚拟变量，它从序列的开头到结尾计算时间步数。



使用时间虚拟变量的线性回归生成模型：
target = weight * time + bias


时间哑变量然后允许我们在时间图中对时间序列拟合曲线,这里时间形成了x轴。


时间步特征让你能够建模时间依赖性。如果一个系列的值可以从它们发生的时间来预测，那么该系列就具有时间依赖性。在《硬皮书销售》系列中，我们可以预测月底的销售通常会高于月初的销售。


滞后特征


滞后特征则与当前时间步之前的观测值有关。例如上一周或上一月的观测值。这些滞后特征有助于模型学习时间序列随时间变化的模式。
为了创建一个滞后特征，我们将目标系列的观察值向后移动，使其看起来发生在较晚的时间。在这里，我们创建了一个1步滞后特征，但也可以通过多步的移动来实现。


使用滞后特征的线性回归得到的模型是：
target = weight * lag + bias

因此，滞后特征使我们能够将曲线拟合到滞后图中，其中每个系列的观测值都与前一个观测值进行绘制。

从滞后图中可以看出，一天的销售量（Hardcover）与前一天的销售量（Lag_1）呈相关性。当你看到这样的关系时，你就知道滞后特征将会很有用。

更一般地说，滞后特征让你能够建模序列依赖性。当观测值可以从先前的观测值中预测时，时间序列就具有序列依赖性。在《硬皮书销售》中，我们可以预测一天的高销售通常意味着下一天的高销售。

将机器学习算法应用于时间序列问题主要涉及到利用时间索引和滞后特征进行特征工程。在大多数情况下，我们使用线性回归因其简单性，但无论你选择哪种算法进行预测任务，这些特征都会很有用。


最好的时间序列模型通常会包含一些时间步特征和滞后特征的组合。